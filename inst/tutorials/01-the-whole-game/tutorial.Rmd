---
title: The Whole Game
author: David Kane and Matthew Ru
tutorial:
  id: the-whole-game
output:
  learnr::tutorial:
    progressive: yes
    allow_skip: yes
runtime: shiny_prerendered
description: 'Tutorial for Chapter 1: The Whole Game'
---

```{r setup, include = FALSE}
library(learnr)
library(tutorial.helpers)
library(devtools)
knitr::opts_chunk$set(echo = FALSE)
options(tutorial.exercise.timelimit = 60, 
        tutorial.storage = "local") 
```

```{r copy-code-chunk, child = system.file("child_documents/copy_button.Rmd", package = "tutorial.helpers")}
```

```{r info-section, child = system.file("child_documents/info_section.Rmd", package = "tutorial.helpers")}
```

<!-- Some notes: -->

<!-- We need not mimic everything that this chapter does. It may be useful to do different things in a different order. -->

<!-- In particular, we will often add extra questions to something which is, originally, a single line of code in the book. That is, we will run something like use_testhat() and then have 6 questions which examine/explain all the changes that this one command caused in the package --- it changes the DESCRIPTION file, it creates the tests directory, it creates the tests/testthat.R script (and let's explain all the lines in that file), and so on. We want a question for each of the changes, even if that question is just readLines(something, something). -->

<!-- One example of a major change is, I think, that the Start with Github (see Happy Ruser book) approach is better than what they do. That is, the first step is to create a Github repo and then connect it to a new R project. -->

## Introduction

### 

This tutorial covers [Chapter 1: The Whole Game](https://r-pkgs.org/whole-game.html) from [*R Packages (2e)*](https://r-pkgs.org/) by [Hadley Wickham](https://hadley.nz/) and [Jennifer Bryan](https://jennybryan.org/). [**devtools**](https://devtools.r-lib.org/) is a package designed to make package development easier by providing R functions that simplify and expedite common tasks.

## Connect RStudio to Git and Github

### 

Visit [Github](https://github.com) and make sure you are logged in.

### Exercise 1

We are going to create a new repository, so click the big green "New" button next to "Repositories".

### Exercise 2

Name your repo `regexcite`.

### Exercise 3

Select the "Public" option for your repo.

### Exercise 4

Lastly, check the box next to "Add a README file" and click the green "Create repository" button.

### 

Recall that a README file is a document where programmers often add or explain details of their project. Visit <https://en.wikipedia.org/wiki/README> for more information.

### Exercise 5

Once you have created your repository, copy the URL of the project page and paste it below. The link should look something like this: `https://github.com/username/repo-name`.

```{r connect-rstudio-to-g-5}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

You may have noticed that we did not specify a `.gitignore` template. We will not have to worry about this setting because RStudio always creates a `.gitignore` file for us.

### Exercise 6

Now, clone the repo by first clicking the big green "Code" button and copying the https link shown.

### 

Paste the link here. It should end in `.git`.

```{r connect-rstudio-to-g-6}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

This link directs to your github project and is a little different from the website URL because the `.git` ending identifies it as a special Github object.

### Exercise 7

Create a new RStudio Project. Visit "File" at the upper left corner and click "New Project". From there, click "Version Control" and select "Git". Now, paste in the `.git` link you copied earlier in the field "Repository URL:". Take note of your project directory, click "Open in new session" and press "Create Project".

### 

### Exercise 8

Open up the terminal panel in your new project and type `ls -a`. CP/CR.

```{r connect-rstudio-to-g-8}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Note the `.Rproj` file that represents your project and the `.gitignore` file that RStudio automatically created.

### Exercise 9

Open up the `.gitignore` file and add `*.Rproj` to the bottom of the file. Save the file.

### 

In the terminal pane, run `cat .gitignore`. CP/CR.

```{r connect-rstudio-to-g-9}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Adding the `*.Rproj` line to the `.gitignore` file tells the computer that we want to avoid uploading all files ending with `.Rproj`. We do not want to include the `.Rproj` file because it mostly contains local settings that are irrelevant to the repository.

### Exercise 10

Now that we have made changes to the `.gitignore` file, click the "Git" tab in the upper righthand corner and select the box on the left of `.gitignore` to stage your changes.

### Exercise 11

Once you have staged them, press the "Commit" button, type a meaningful initial commit message, and press commit.

### Exercise 12

Finally, press the green "Push" button to push your changes to Github.

### Exercise 13

Run `gert::git_ahead_behind()$ahead` in the console to make sure you pushed your changes. CP/CR.

```{r connect-rstudio-to-g-13}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

This should return `0` meaning that there are `0` changes out of sync with Github.

## Load devtools and friends

### Exercise 1

Load the `devtools` library with `library()` in the console. CP/CR.

```{r load-devtools-and-fr-1}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

`devtools` is the public face of a set of packages that support various aspects of package development. Many of our commands will come from `usethis` and `devtools` is a convenient way to load everything we need at once.

### Exercise 2

Run `packageVersion("devtools")` to make sure that your version of `devtools` is up to date. CP/CR.

```{r load-devtools-and-fr-2}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Your version should read `'2.4.5'`. Upgrade your version if necessary using `install.packages("devtools")`.

### Exercise 3

Run the `create_package()` command to initialize a new package in a directory on your computer. Use the path to your project directory as an argument like this: `create_package("~/path/to/regexcite")`. CP/CR.

```{r load-devtools-and-fr-3}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

It will prompt you if you want to overwrite the `.Rproj` file, select "Yes". (This will put you in a new RStudio Session).

### Exercise 4

Run `library()` again to reload in `devtools` since `create_package()` has put you in a new R sesssion.

### 

We will be writing a toy package called `regexcite` and it contains a couple of functions that make common tasks with regular expressions easier. Although this is just to demonstrate the typical workflow for package development, we encourage you to preview the finished product on Github: <https://github.com/jennybc/regexcite>.

### Exercise 5

Run `ls -a` in the terminal of your new session and take note of all the new files `create_package()` has created. CP/CR

```{r load-devtools-and-fr-5}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

You should see new `.Rbuildignore`, `NAMESPACE`, `DESCRIPTION` files and a new `R` directory.

### Exercise 6

Run `cat .Rbuildignore` in the terminal panel and CP/CR.

```{r load-devtools-and-fr-6}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

`.Rbuildignore` lists files that we need to have around but that should not be included when building the R package from source.

### Exercise 7

Run `cat DESCRIPTION` in the terminal and CP/CR.

```{r load-devtools-and-fr-7}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

`DESCRIPTION` provides metadata about your package and we edit this shortly.

### Exercise 8

Run `cat NAMESPACE` in the terminal and CP/CR.

```{r load-devtools-and-fr-8}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

`NAMESPACE` declares the functions your package exports for external use and the external functions your package imports from other packages. At this point, it is empty, except for a comment declaring that this is a file you should not edit by hand.

### Exercise 9

Run `ls R` to list all the files in the new `R` directory (there are none).

```{r load-devtools-and-fr-9}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

The `R/` directory is the "business end" of your package. It will soon contain `.R` files with function definitions.

### Exercise 10

Stage all changes in the Git tab, press "commit", and write a meaningful commit message (e.g. Created Package). Finally, press "Commit" and "Push".

### Exercise 11

Run `gert::git_ahead_behind()$ahead` again in the console to make sure you pushed your changes. CP/CR.

```{r load-devtools-and-fr-11}
question_text(NULL,
	answer(NULL, correct = TRUE),
	allow_retry = TRUE,
	try_again_button = "Edit Answer",
	incorrect = NULL,
	rows = 3)
```

### 

Once again, this should show that there are `0` changes out of sync with Github.

## Write the first function

### 

## Summary

### 

This tutorial covered [Chapter 1: The Whole Game](https://r-pkgs.org/whole-game.html) from [*R Packages (2e)*](https://r-pkgs.org/) by [Hadley Wickham](https://hadley.nz/) and [Jennifer Bryan](https://jennybryan.org/). [**devtools**](https://devtools.r-lib.org/) is a package designed to make package development easier by providing R functions that simplify and expedite common tasks.

```{r download-answers, child = system.file("child_documents/download_answers.Rmd", package = "tutorial.helpers")}
```
